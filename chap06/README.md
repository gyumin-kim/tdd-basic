# CHAPTER 6 — 테스트 코드의 구성

## 상황
- 주어진 상황에 따라 기능 실행 결과는 달라진다.
- 다양한 예외 상황을 찾아 내고 이를 코드에 반영해야 기능이 비정상적으로 동작하는 것을 막을 수 있다.
    - 가능한 많은 예외 상황을 찾아내기 위해 노력해야 한다.

## 테스트 코드의 구성 요소
- 상황, 실행, 결과 확인
    - 어떤 상황이 주어지고, 그 상황에서 기능을 실행하고, 실행한 결과를 확인
    - given, when, then

## 외부 상황과 외부 결과
- 테스트를 실행할 때마다 동일한 결과를 보장해야 한다(우연에 의해 결과가 달라지면 안된다).
### 외부 상태가 테스트 결과에 영향을 주지 않게 하기
- 외부 상태란 테스트 결과에 영향을 미칠 수도 있는 DB의 데이터 등을 의미한다.
- 외부 상태에 따라 테스트의 성공 여부가 바뀌지 않으려면, 테스트 실행 전에 외부를 원하는 상태로 만들어 두거나 테스트 실행 후에 외부 상태를 원래대로 되돌려 놓아야 한다.
    - 테스트 실행 후 데이터를 삭제하면서 테스트를 끝내거나, 트랜잭션을 롤백하는 등의 방법이 있다.
### 외부 상태와 테스트 어려움
- 테스트 대상이 아닌 외부 요인은 테스트 코드에서 다루기 힘든 존재이다.
    - ex) 외부 REST API를 호출하고 그 응답에 따라 테스트 결과가 달라질 수도 있는 경우
    - 테스트 대상의 상황과 결과에 외부 요인이 관여하는 경우, 대역(double)을 사용하면 테스트 작성이 쉬워진다.
        - 대역이란 실제 구현을 대신하는 것으로, 대역을 통해 외부 상황이나 결과를 대체할 수 있다.